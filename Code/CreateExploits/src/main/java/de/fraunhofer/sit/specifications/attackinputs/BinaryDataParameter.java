package de.fraunhofer.sit.specifications.attackinputs;

import java.util.Base64;

import org.w3c.dom.Node;

import de.fraunhofer.sit.specifications.util.XMLUtils;

public class BinaryDataParameter extends InputParameter {
	private byte[] data;
	@Override
	public String getTagName() {
		return "Base64Data";
	}

	@Override
	public void readIn(Node node) {
		id = XMLUtils.getAttributeValue(node, "id");
		int repeat = Integer.parseInt(XMLUtils.getAttributeValue(node, "repeat", "1"));
		data = Base64.getDecoder().decode(node.getTextContent().getBytes());
		
		if (repeat > 1) {
			byte[] repeated = new byte[data.length * repeat];
			for (int i = 0; i < repeat; i++) 
				System.arraycopy(data, 0, repeated, data.length * i, data.length);
			
			data = repeated;
				
		}
	}
	public byte[] getData() {
		return data;
	}

}
